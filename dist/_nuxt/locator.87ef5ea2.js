import{_ as se}from"./nuxt-link.0e88b747.js";import{h as oe,i as u,j as ne,k as ae,l as le,r as i,o as d,a as v,u as c,c as y,w as n,m as E,e as l,p as re,b as e,q as R,v as D,F as L,S as f,f as h,t as r,s as $,x as ce,y as ie,z as de,A as ue,B as _e}from"./entry.b15e0e18.js";const pe=""+globalThis.__publicAssetsURL("food.png");const _=m=>(ie("data-v-1f7d243a"),m=m(),de(),m),fe=_(()=>e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"S/N"),e("th",{class:"text-left"},"Organizer"),e("th",{class:"text-left"},"Meal Type"),e("th",{class:"text-left"},"Landmark"),e("th",{class:"text-left"},"Address")])],-1)),he=["href"],ge={class:"s-text-field"},ve={class:"mt-7"},xe={class:"shadow d-flex rounded-lg pa-2 position-relative"},ye=_(()=>e("div",{class:"d-flex justify-content-center align-center foodImage"},[e("img",{src:pe,width:"100"})],-1)),me={class:"foundation"},be={class:"content-x"},ke=_(()=>e("span",{class:"text-green heading-x"},"Meal: ",-1)),we={class:"content-x"},Ce=_(()=>e("span",{class:"text-green heading-x"},"Location: ",-1)),Be=_(()=>e("span",{class:"text-green heading-x"},"Address: ",-1)),Se={class:"content-x"},Le={class:"display-type"},Ae=_(()=>e("span",{color:"#F5891B",class:"heading-x"},"Date: Today ",-1)),ze={class:"content-x"},Me=_(()=>e("p",{class:"d-none d-sm-flex",style:{margin:"0px 8px",width:"3px",background:"#ccc",height:"inherit"}},null,-1)),Ne=_(()=>e("span",{color:"#F5891B",class:"heading-x"},"Available Slot: ",-1)),Pe={class:"content-x"},Te={class:"d-flex align-center"},Ve={key:0,class:"distance-away"},Ie={key:1,class:"fs1 d-flex justify-center text-grey text-center pa-6"},Ee=_(()=>e("a",{href:"#",class:"mt-5 d-block"},"Show More",-1)),Re={class:"fs1 text-grey text-center pa-6"},De={__name:"locator",setup(m){u(!0);const x=u(!1);u(""),u({});const k=u(""),j=u(""),w=u([]),F=u({lat:51.093048,lng:6.84212}),{$api:C}=ne(),a=ae();function G(t){j.value=t.url,k.value=t.formatted_address,w.value={lat:t.geometry.location.lat(),long:t.geometry.location.lng()}}const B=u([]),A=u([]);function O(t){return t=t.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[t],t.length>1&&(t=t.slice(1),t[5]=+t[0]<12?"AM":"PM",t[0]=+t[0]%12||12),t.join("")}async function U(){if(this.address=="")return f.fire("Enter a location or an address phrase"),!1;M(w.value.long,w.value.lat)}async function q(){return ue.value=!1,a.isLoading=!0,await f.fire({title:"Enter Your Phone Number",html:'<input id="swal-input1" class="swal2-input mb-3" placeholder="Phone Number">',showCancelButton:!0,confirmButtonText:"Look up",showLoaderOnConfirm:!0,preConfirm:async()=>{let t=document.getElementById("swal-input1").value;if(t=="")f.showValidationMessage("Invalid Phone Number");else try{return _e.get(a.baseUrl+"/beneficiaries/"+t).then(o=>(o.error&&f.showValidationMessage(o.responseBody),a.beneficiary_access_token=o.data.responseBody.accessToken,a.beneficiary=o.data.responseBody.user,a.access_token="",!0))}catch(o){console.log(o)}},allowOutsideClick:!1}).then(async t=>t.isConfirmed?!0:(a.isLoading=!1,!1))}async function H(t,o=!1){a.beneficiary_access_token==""&&o==!1?await q()&&await z(t):await z(t)}a.resetStore();async function z(t){try{a.isLoading=!0;let o=await C.postData("/reservations","POST",{meal_id:t},"/locator",!0,!1);o.error?o.status==409?(f.fire(o.responseBody.message),a.beneficiary.reservation_ids.push(t)):f.fire(o.responseBody):(a.beneficiary.reservation_ids.push(t),a.isLoading=!1)}catch(o){console.log(o)}}async function M(t="",o=""){let p="";t!=""&&(p=t+"/"+o);let b=await C.postData("/meals/"+p,"GET",{},"/locator");b.error||(B.value=b.responseBody)}const W=t=>{console.log(t),M(t.coords.longitude,t.coords.latitude)},Y=t=>{console.log(t)};navigator.geolocation.getCurrentPosition(W,Y,{enableHighAccuracy:!0,timeout:1e4}),le(()=>k.value===""?"12px":"-12px");async function J(){let t=await C.postData("/reservations","GET",{},"/locator",!0,!1);t.error?f.fire("something went wrong"):(A.value=t.responseBody,x.value=!0)}return(t,o)=>{const p=i("v-btn"),b=i("v-card-title"),K=i("v-table"),Q=i("v-card-text"),N=i("v-spacer"),X=i("v-card-actions"),Z=i("v-card"),ee=i("v-dialog"),te=i("GMapAutocomplete"),S=i("v-col"),P=i("v-row"),T=se;return d(),v(L,null,[c(a).beneficiary_access_token!=""?(d(),y(p,{key:0,onClick:o[0]||(o[0]=s=>J()),size:"small",style:{padding:"6px",width:"28px !important",height:"28px !important","border-radius":"20px",position:"absolute",top:"60px",right:"60px","font-size":"0.8em"},class:"bg-orange text-white d-flex justify-center align-center"},{default:n(()=>{var s,g;return[h(r((g=(s=c(a).beneficiary)==null?void 0:s.reservation_ids)==null?void 0:g.length),1)]}),_:1})):E("",!0),l(ee,{size:"large",modelValue:c(x),"onUpdate:modelValue":o[2]||(o[2]=s=>re(x)?x.value=s:null),persistent:"",width:"auto"},{default:n(()=>[l(Z,{style:{"min-width":"350px"},class:"pa-4"},{default:n(()=>[l(b,{class:"text-h5"},{default:n(()=>[h(" All today's Reservation ")]),_:1}),l(Q,null,{default:n(()=>[l(K,{density:"compact","fixed-header":""},{default:n(()=>[fe,e("tbody",null,[(d(!0),v(L,null,$(c(A),(s,g)=>(d(),v("tr",{key:s.id},[e("td",null,r(g+1),1),e("td",null,r(s.organizer.name),1),e("td",null,r(s.meal_type),1),e("td",null,r(s.landmark),1),e("td",null,[e("a",{href:s.address_url,target:"_blank",class:"underlined text-orange"},r(s.address),9,he)])]))),128))])]),_:1})]),_:1}),l(X,null,{default:n(()=>[l(N),l(p,{color:"green-darken-1",variant:"text",onClick:o[1]||(o[1]=s=>x.value=!1)},{default:n(()=>[h("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(P,null,{default:n(()=>[l(S,{cols:"12",md:"6",lg:"6",xl:"6"},{default:n(()=>[e("div",ge,[l(te,{class:"pa-0",onPlace_changed:G}),e("label",{style:ce(c(k)!=""?{"font-size":"10px",top:"3.5px"}:{top:"12px"}),class:"label"},"Address",4)])]),_:1}),l(S,{cols:"12",md:"6",lg:"6",xl:"6"},{default:n(()=>[l(p,{onClick:o[3]||(o[3]=s=>U()),class:"me-2 mt-2",color:"green"},{default:n(()=>[h("Search Location")]),_:1})]),_:1})]),_:1}),e("div",ve,[R(e("div",null,[c(B).length>0?(d(),y(P,{key:0},{default:n(()=>[(d(!0),v(L,null,$(c(B),(s,g)=>(d(),y(S,{key:g,cols:"12",lg:"6",xl:"6"},{default:n(()=>{var V,I;return[e("div",xe,[ye,e("div",null,[e("p",me,[e("span",be,r(s.organizer.name),1)]),e("p",null,[ke,h(),l(T,{to:"https://www.google.com/search?tbm=isch&q=food:"+s.meal_type,target:"_blank",class:"underlined"},{default:n(()=>[e("span",we,r(s.meal_type),1)]),_:2},1032,["to"])]),e("p",null,[Ce,e("span",null,r(s.landmark),1)]),e("p",null,[Be,l(T,{to:s.address_url,target:"_blank",class:"underlined"},{default:n(()=>[e("span",Se,r(s.address.slice(0,40))+"...",1)]),_:2},1032,["to"])]),e("div",Le,[e("p",null,[Ae,e("span",ze,r(O(s==null?void 0:s.time_slot)),1)]),Me,e("p",null,[Ne,e("span",Pe,r(s.maximum_capacity-s.total_reservations),1)])]),e("div",Te,[(I=(V=c(a).beneficiary)==null?void 0:V.reservation_ids)!=null&&I.includes(s.id)?(d(),y(p,{key:0,disabled:!0,size:"small",color:"green",class:"mx-auto d-inline-block my-1"},{default:n(()=>[h("Reserved for "+r(c(a).beneficiary.phone_number),1)]),_:1})):(d(),y(p,{key:1,size:"small",color:"green",onClick:$e=>H(s.id),class:"mx-auto d-inline-block my-1"},{default:n(()=>[h("Make Reservation")]),_:2},1032,["onClick"])),l(N),e("div",null,[s!=null&&s.distance?(d(),v("span",Ve,[e("b",null,r(parseInt(s.distance))+"km away ",1)])):E("",!0)])])])])]}),_:2},1024))),128))]),_:1})):(d(),v("div",Ie," We could not find iftar dinner or ensure your GPS is turned-on ")),l(c(F),null,{default:n(()=>[Ee]),_:1})],512),[[D,c(a).isLoading===!1]]),R(e("div",Re," Fetching... ",512),[[D,c(a).isLoading==!0]])])],64)}}},Ge=oe(De,[["__scopeId","data-v-1f7d243a"]]);export{Ge as default};
