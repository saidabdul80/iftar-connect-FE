import{_ as ae}from"./nuxt-link.b2492274.js";import{h as ne,i as u,j as le,k as re,l as ce,r as c,o as d,a as v,u as i,c as y,w as a,m as D,e as n,p as ie,b as e,q as $,v as j,F as L,S as h,f as _,t as r,s as F,x as de,n as ue,g as _e,y as pe,z as fe,A as he,B as ge}from"./entry.755f94c3.js";const ve=""+globalThis.__publicAssetsURL("food.png");const p=m=>(pe("data-v-7d66dc28"),m=m(),fe(),m),xe=p(()=>e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"S/N"),e("th",{class:"text-left"},"Organizer"),e("th",{class:"text-left"},"Meal Type"),e("th",{class:"text-left"},"Landmark"),e("th",{class:"text-left"},"Address")])],-1)),ye=["href"],me={class:"s-text-field"},be={class:"mt-7"},ke={class:"shadow d-flex rounded-lg pa-2 position-relative"},we=p(()=>e("div",{class:"d-flex justify-content-center align-center foodImage"},[e("img",{src:ve,width:"100"})],-1)),Ce={class:"foundation"},Be={class:"content-x"},Se=p(()=>e("span",{class:"text-green heading-x"},"Meal: ",-1)),Le={class:"content-x"},ze=p(()=>e("span",{class:"text-green heading-x"},"Location: ",-1)),Ae=p(()=>e("span",{class:"text-green heading-x"},"Address: ",-1)),Me={class:"content-x"},Pe={class:"display-type"},Ne=p(()=>e("span",{color:"#F5891B",class:"heading-x"},"Date: Today ",-1)),Te={class:"content-x"},Ve=p(()=>e("p",{class:"d-none d-sm-flex",style:{margin:"0px 8px",width:"3px",background:"#ccc",height:"inherit"}},null,-1)),Ie=p(()=>e("span",{color:"#F5891B",class:"heading-x"},"Available Slot: ",-1)),Re={class:"content-x"},Ee={class:"d-flex align-center"},De={key:0,class:"distance-away"},$e={key:1,class:"fs1 d-flex justify-center text-grey text-center pa-6"},je=p(()=>e("a",{href:"#",class:"mt-5 d-block"},"Show More",-1)),Fe={class:"fs1 text-grey text-center pa-6"},Ge={__name:"locator",setup(m){u(!0);const x=u(!1);u(""),u({});const b=u(""),G=u(""),w=u([]),O=u({lat:51.093048,lng:6.84212}),{$api:C}=le(),l=re();function U(t){G.value=t.url,b.value=t.formatted_address,w.value={lat:t.geometry.location.lat(),long:t.geometry.location.lng()}}const B=u([]),z=u([]);function q(t){return t=t.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[t],t.length>1&&(t=t.slice(1),t[5]=+t[0]<12?"AM":"PM",t[0]=+t[0]%12||12),t.join("")}async function H(){try{if(b.value=="")return h.fire("Enter a location or an address phrase"),!1;M(w.value.long,w.value.lat)}catch{}}async function W(){return he.value=!1,l.isLoading=!0,await h.fire({title:"Enter Your Phone Number",html:'<input id="swal-input1" class="swal2-input mb-3" placeholder="Phone Number">',showCancelButton:!0,confirmButtonText:"Look up",showLoaderOnConfirm:!0,preConfirm:async()=>{let t=document.getElementById("swal-input1").value;if(t=="")h.showValidationMessage("Invalid Phone Number");else try{return ge.get(l.baseUrl+"/beneficiaries/"+t).then(o=>(o.error&&h.showValidationMessage(o.responseBody),l.beneficiary_access_token=o.data.responseBody.accessToken,l.beneficiary=o.data.responseBody.user,l.access_token="",!0))}catch(o){console.log(o)}},allowOutsideClick:!1}).then(async t=>t.isConfirmed?!0:(l.isLoading=!1,!1))}async function Y(t,o=!1){l.beneficiary_access_token==""&&o==!1?await W()&&await A(t):await A(t)}l.resetStore();async function A(t){try{l.isLoading=!0;let o=await C.postData("/reservations","POST",{meal_id:t},"/locator",!0,!1);o.error?o.status==409?(h.fire(o.responseBody.message),l.beneficiary.reservation_ids.push(t)):h.fire(o.responseBody):(l.beneficiary.reservation_ids.push(t),l.isLoading=!1)}catch(o){console.log(o)}}async function M(t="",o=""){let f="";t!=""&&(f=t+"/"+o);let k=await C.postData("/meals/"+f,"GET",{},"/locator");k.error||(B.value=k.responseBody)}const J=t=>{console.log(t),M(t.coords.longitude,t.coords.latitude)},K=t=>{console.log(t)};navigator.geolocation.getCurrentPosition(J,K,{enableHighAccuracy:!0,timeout:1e4}),ce(()=>b.value===""?"12px":"-12px");async function Q(){let t=await C.postData("/reservations","GET",{},"/locator",!0,!1);t.error?h.fire("something went wrong"):(z.value=t.responseBody,x.value=!0)}return(t,o)=>{const f=c("v-btn"),k=c("v-card-title"),X=c("v-table"),Z=c("v-card-text"),P=c("v-spacer"),ee=c("v-card-actions"),te=c("v-card"),se=c("v-dialog"),oe=c("GMapAutocomplete"),S=c("v-col"),N=c("v-row"),T=ae,V=c("v-tooltip");return d(),v(L,null,[i(l).beneficiary_access_token!=""?(d(),y(f,{key:0,onClick:o[0]||(o[0]=s=>Q()),size:"small",style:{padding:"6px",width:"28px !important",height:"28px !important","border-radius":"20px",position:"absolute",top:"60px",right:"60px","font-size":"0.8em"},class:"bg-orange text-white d-flex justify-center align-center"},{default:a(()=>{var s,g;return[_(r((g=(s=i(l).beneficiary)==null?void 0:s.reservation_ids)==null?void 0:g.length),1)]}),_:1})):D("",!0),n(se,{size:"large",modelValue:i(x),"onUpdate:modelValue":o[2]||(o[2]=s=>ie(x)?x.value=s:null),persistent:"",width:"auto"},{default:a(()=>[n(te,{style:{"min-width":"350px"},class:"pa-4"},{default:a(()=>[n(k,{class:"text-h5"},{default:a(()=>[_(" All today's Reservation ")]),_:1}),n(Z,null,{default:a(()=>[n(X,{density:"compact","fixed-header":""},{default:a(()=>[xe,e("tbody",null,[(d(!0),v(L,null,F(i(z),(s,g)=>(d(),v("tr",{key:s.id},[e("td",null,r(g+1),1),e("td",null,r(s.organizer.name),1),e("td",null,r(s.meal_type),1),e("td",null,r(s.landmark),1),e("td",null,[e("a",{href:s.address_url,target:"_blank",class:"underlined text-orange"},r(s.address),9,ye)])]))),128))])]),_:1})]),_:1}),n(ee,null,{default:a(()=>[n(P),n(f,{color:"green-darken-1",variant:"text",onClick:o[1]||(o[1]=s=>x.value=!1)},{default:a(()=>[_("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(N,null,{default:a(()=>[n(S,{cols:"12",md:"6",lg:"6",xl:"6"},{default:a(()=>[e("div",me,[n(oe,{class:"pa-0",onPlace_changed:U}),e("label",{style:de(i(b)!=""?{"font-size":"10px",top:"3.5px"}:{top:"12px"}),class:"label"},"Address",4)])]),_:1}),n(S,{cols:"12",md:"6",lg:"6",xl:"6"},{default:a(()=>[n(f,{onClick:o[3]||(o[3]=s=>H()),class:"me-2 mt-2",color:"green"},{default:a(()=>[_("Search Location")]),_:1})]),_:1})]),_:1}),e("div",be,[$(e("div",null,[i(B).length>0?(d(),y(N,{key:0},{default:a(()=>[(d(!0),v(L,null,F(i(B),(s,g)=>(d(),y(S,{key:g,cols:"12",lg:"6",xl:"6"},{default:a(()=>{var I,R;return[e("div",ke,[we,e("div",null,[e("p",Ce,[e("span",Be,r(s.organizer.name),1)]),e("p",null,[Se,_(),n(T,{to:"https://www.google.com/search?tbm=isch&q=food:"+s.meal_type,target:"_blank",class:"underlined"},{default:a(()=>[e("span",Le,r(s.meal_type),1)]),_:2},1032,["to"])]),e("p",null,[ze,e("span",null,[_(r(s.landmark.slice(0,25))+"... ",1),n(V,{activator:"parent",location:"top"},{default:a(()=>[_(r(s.landmark),1)]),_:2},1024)])]),n(V,{text:s.address,location:"top"},{activator:a(({props:E})=>[e("p",ue(_e(E)),[Ae,n(T,{to:s.address_url,target:"_blank",class:"underlined"},{default:a(()=>[e("span",Me,r(s.address.slice(0,25))+"...",1)]),_:2},1032,["to"])],16)]),_:2},1032,["text"]),e("div",Pe,[e("p",null,[Ne,e("span",Te,r(q(s==null?void 0:s.time_slot)),1)]),Ve,e("p",null,[Ie,e("span",Re,r(s.maximum_capacity-s.total_reservations),1)])]),e("div",Ee,[(R=(I=i(l).beneficiary)==null?void 0:I.reservation_ids)!=null&&R.includes(s.id)?(d(),y(f,{key:0,disabled:!0,size:"small",color:"green",class:"mx-auto d-inline-block my-1"},{default:a(()=>[_("Reserved for "+r(i(l).beneficiary.phone_number),1)]),_:1})):(d(),y(f,{key:1,size:"small",color:"green",onClick:E=>Y(s.id),class:"mx-auto d-inline-block my-1"},{default:a(()=>[_("Make Reservation")]),_:2},1032,["onClick"])),n(P),e("div",null,[s!=null&&s.distance?(d(),v("span",De,[e("b",null,r(parseInt(s.distance))+"km away ",1)])):D("",!0)])])])])]}),_:2},1024))),128))]),_:1})):(d(),v("div",$e," We could not find iftar dinner or ensure your GPS is turned-on ")),n(i(O),null,{default:a(()=>[je]),_:1})],512),[[j,i(l).isLoading===!1]]),$(e("div",Fe," Fetching... ",512),[[j,i(l).isLoading==!0]])])],64)}}},qe=ne(Ge,[["__scopeId","data-v-7d66dc28"]]);export{qe as default};
