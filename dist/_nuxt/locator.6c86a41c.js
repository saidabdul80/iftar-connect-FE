import{_ as Z}from"./nuxt-link.1e07df38.js";import{h as ee,i,j as te,k as se,l as oe,r as c,o as d,a as m,u,c as b,w as a,m as P,e as n,p as ae,b as e,F as S,S as f,f as h,t as r,q as R,s as ne,v as le,x as re,y as ce,z as ie}from"./entry.2d6b1787.js";const de=""+globalThis.__publicAssetsURL("food.png");const p=x=>(le("data-v-b4a569ad"),x=x(),re(),x),ue=p(()=>e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"S/N"),e("th",{class:"text-left"},"Organizer"),e("th",{class:"text-left"},"Meal Type"),e("th",{class:"text-left"},"Address")])],-1)),_e=["href"],pe={class:"s-text-field"},fe={class:"mt-7"},he={class:"shadow d-flex rounded-lg pa-2 position-relative"},ge=p(()=>e("div",{class:"d-flex justify-content-center align-center foodImage"},[e("img",{src:de,width:"100"})],-1)),ve={class:"foundation"},me={class:"content-x"},xe=p(()=>e("span",{class:"text-green heading-x"},"Meal: ",-1)),ye={class:"content-x"},be=p(()=>e("span",{class:"text-green heading-x"},"Address: ",-1)),we={class:"content-x"},ke={class:"display-type"},Ce=p(()=>e("span",{color:"#F5891B",class:"heading-x"},"Date: Today ",-1)),Be={class:"content-x"},Se=p(()=>e("p",{class:"d-none d-sm-flex",style:{margin:"0px 8px",width:"3px",background:"#ccc",height:"inherit"}},null,-1)),ze=p(()=>e("span",{color:"#F5891B",class:"heading-x"},"Available Slot: ",-1)),Le={class:"content-x"},Ae={class:"d-flex align-center"},Ne={key:0,class:"distance-away"},Me=p(()=>e("a",{href:"#",class:"mt-5 d-block"},"Show More",-1)),Te={__name:"locator",setup(x){const v=i(!1);i(""),i({});const w=i(""),D=i(""),k=i([]),$=i({lat:51.093048,lng:6.84212}),{$api:C}=te(),l=se();function F(s){D.value=s.url,w.value=s.formatted_address,k.value={lat:s.geometry.location.lat(),long:s.geometry.location.lng()}}const z=i([]),L=i([]);async function G(){if(this.address=="")return f.fire("Enter a location or an address phrase"),!1;N(k.value.long,k.value.lat)}async function O(){return ce.value=!1,l.isLoading=!0,await f.fire({title:"Enter Your Phone Number",html:'<input id="swal-input1" class="swal2-input mb-3" placeholder="Phone Number">',showCancelButton:!0,confirmButtonText:"Look up",showLoaderOnConfirm:!0,preConfirm:async()=>{let s=document.getElementById("swal-input1").value;if(s=="")f.showValidationMessage("Invalid Phone Number");else{console.log(l);try{return ie.get(l.baseUrl+"/beneficiaries/"+s).then(o=>(o.error&&f.showValidationMessage(o.responseBody),l.beneficiary_access_token=o.data.responseBody.accessToken,l.beneficiary=o.data.responseBody.user,l.access_token="",!0))}catch(o){console.log(o)}}},allowOutsideClick:!1}).then(async s=>s.isConfirmed?!0:(l.isLoading=!1,!1))}async function U(s,o=!1){l.beneficiary_access_token==""&&o==!1?await O()&&await A(s):await A(s)}async function A(s){try{l.isLoading=!0;let o=await C.postData("/reservations","POST",{meal_id:s},"/locator",!0,!1);o.error?o.status==409?(f.fire(o.responseBody.message),l.beneficiary.reservation_ids.push(s)):f.fire(o.responseBody):(l.beneficiary.reservation_ids.push(s),l.isLoading=!1)}catch(o){console.log(o)}}async function N(s="",o=""){let _="";s!=""&&(_=s+"/"+o);let y=await C.postData("/meals/"+_,"GET",{},"/locator");y.error||(z.value=y.responseBody)}const j=s=>{console.log(s),N(s.coords.longitude,s.coords.latitude)},q=s=>{console.log(s)};navigator.geolocation.getCurrentPosition(j,q,{enableHighAccuracy:!0,timeout:1e4}),oe(()=>w.value===""?"12px":"-12px");async function H(){let s=await C.postData("/reservations","GET",{},"/locator",!0,!1);s.error?f.fire("something went wrong"):(L.value=s.responseBody,v.value=!0)}return(s,o)=>{const _=c("v-btn"),y=c("v-card-title"),Y=c("v-table"),J=c("v-card-text"),M=c("v-spacer"),K=c("v-card-actions"),Q=c("v-card"),W=c("v-dialog"),X=c("GMapAutocomplete"),B=c("v-col"),T=c("v-row"),V=Z;return d(),m(S,null,[u(l).beneficiary_access_token!=""?(d(),b(_,{key:0,onClick:o[0]||(o[0]=t=>H()),size:"small",style:{padding:"6px",width:"28px !important",height:"28px !important","border-radius":"20px",position:"absolute",top:"60px",right:"60px","font-size":"0.8em"},class:"bg-orange text-white d-flex justify-center align-center"},{default:a(()=>{var t,g;return[h(r((g=(t=u(l).beneficiary)==null?void 0:t.reservation_ids)==null?void 0:g.length),1)]}),_:1})):P("",!0),n(W,{size:"large",modelValue:u(v),"onUpdate:modelValue":o[2]||(o[2]=t=>ae(v)?v.value=t:null),persistent:"",width:"auto"},{default:a(()=>[n(Q,{style:{"min-width":"350px"},class:"pa-4"},{default:a(()=>[n(y,{class:"text-h5"},{default:a(()=>[h(" All today's Reservation ")]),_:1}),n(J,null,{default:a(()=>[n(Y,{density:"compact","fixed-header":""},{default:a(()=>[ue,e("tbody",null,[(d(!0),m(S,null,R(u(L),(t,g)=>(d(),m("tr",{key:t.id},[e("td",null,r(g+1),1),e("td",null,r(t.organizer.name),1),e("td",null,r(t.meal_type),1),e("td",null,[e("a",{href:t.address_url,target:"_blank",class:"underlined text-orange"},r(t.address),9,_e)])]))),128))])]),_:1})]),_:1}),n(K,null,{default:a(()=>[n(M),n(_,{color:"green-darken-1",variant:"text",onClick:o[1]||(o[1]=t=>v.value=!1)},{default:a(()=>[h("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(T,null,{default:a(()=>[n(B,{cols:"12",md:"6",lg:"6",xl:"6"},{default:a(()=>[e("div",pe,[n(X,{class:"pa-0",onPlace_changed:F}),e("label",{style:ne(u(w)!=""?{"font-size":"10px",top:"3.5px"}:{top:"12px"}),class:"label"},"Address",4)])]),_:1}),n(B,{cols:"12",md:"6",lg:"6",xl:"6"},{default:a(()=>[n(_,{onClick:o[3]||(o[3]=t=>G()),class:"me-2 mt-2",color:"green"},{default:a(()=>[h("Search Location")]),_:1})]),_:1})]),_:1}),e("div",fe,[n(T,null,{default:a(()=>[(d(!0),m(S,null,R(u(z),(t,g)=>(d(),b(B,{key:g,cols:"12",lg:"6",xl:"6"},{default:a(()=>{var I,E;return[e("div",he,[ge,e("div",null,[e("p",ve,[e("span",me,r(t.organizer.name),1)]),e("p",null,[xe,h(),n(V,{to:"https://www.google.com/search?tbm=isch&q=food:"+t.meal_type,target:"_blank",class:"underlined"},{default:a(()=>[e("span",ye,r(t.meal_type),1)]),_:2},1032,["to"])]),e("p",null,[be,n(V,{to:t.address_url,target:"_blank",class:"underlined"},{default:a(()=>[e("span",we,r(t.address.slice(0,40))+"...",1)]),_:2},1032,["to"])]),e("div",ke,[e("p",null,[Ce,e("span",Be,r(t==null?void 0:t.time_slot),1)]),Se,e("p",null,[ze,e("span",Le,r(t.maximum_capacity-t.total_reservations),1)])]),e("div",Ae,[(E=(I=u(l).beneficiary)==null?void 0:I.reservation_ids)!=null&&E.includes(t.id)?(d(),b(_,{key:0,disabled:!0,size:"small",color:"green",class:"mx-auto d-inline-block my-1"},{default:a(()=>[h("Reserved for "+r(u(l).beneficiary.phone_number),1)]),_:1})):(d(),b(_,{key:1,size:"small",color:"green",onClick:Ve=>U(t.id),class:"mx-auto d-inline-block my-1"},{default:a(()=>[h("Make Reservation")]),_:2},1032,["onClick"])),n(M),e("div",null,[t!=null&&t.distance?(d(),m("span",Ne,[e("b",null,r(parseInt(t.distance))+"km away ",1)])):P("",!0)])])])])]}),_:2},1024))),128))]),_:1}),n(u($),null,{default:a(()=>[Me]),_:1})])],64)}}},Pe=ee(Te,[["__scopeId","data-v-b4a569ad"]]);export{Pe as default};
